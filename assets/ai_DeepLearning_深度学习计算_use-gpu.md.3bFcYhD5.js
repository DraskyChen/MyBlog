import{_ as l,c as n,o as t,ag as p,j as i,a}from"./chunks/framework.C2Gjomh7.js";const h="/MyBlog/assets/copyto.CGeUF03k.svg",T=JSON.parse('{"title":"GPU","description":"","frontmatter":{},"headers":[],"relativePath":"ai/DeepLearning/æ·±åº¦å­¦ä¹ è®¡ç®—/use-gpu.md","filePath":"ai/DeepLearning/æ·±åº¦å­¦ä¹ è®¡ç®—/use-gpu.md","lastUpdated":1756829839000}'),e={name:"ai/DeepLearning/æ·±åº¦å­¦ä¹ è®¡ç®—/use-gpu.md"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},o={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.553ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 4222.4 688","aria-hidden":"true"};function C(b,s,v,m,A,D){return t(),n("div",null,[s[53]||(s[53]=p(`<h1 id="gpu" tabindex="-1">GPU <a class="header-anchor" href="#gpu" aria-label="Permalink to &quot;GPU&quot;">â€‹</a></h1><p>ğŸ·ï¸<code>sec_use_gpu</code></p><p>åœ¨ :numref:<code>tab_intro_decade</code>ä¸­ï¼Œ æˆ‘ä»¬å›é¡¾äº†è¿‡å»20å¹´è®¡ç®—èƒ½åŠ›çš„å¿«é€Ÿå¢é•¿ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œè‡ª2000å¹´ä»¥æ¥ï¼ŒGPUæ€§èƒ½æ¯åå¹´å¢é•¿1000å€ã€‚</p><p>æœ¬èŠ‚ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•åˆ©ç”¨è¿™ç§è®¡ç®—æ€§èƒ½è¿›è¡Œç ”ç©¶ã€‚ é¦–å…ˆæ˜¯å¦‚ä½•ä½¿ç”¨å•ä¸ªGPUï¼Œç„¶åæ˜¯å¦‚ä½•ä½¿ç”¨å¤šä¸ªGPUå’Œå¤šä¸ªæœåŠ¡å™¨ï¼ˆå…·æœ‰å¤šä¸ªGPUï¼‰ã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹çœ‹å¦‚ä½•ä½¿ç”¨å•ä¸ªNVIDIA GPUè¿›è¡Œè®¡ç®—ã€‚ é¦–å…ˆï¼Œç¡®ä¿è‡³å°‘å®‰è£…äº†ä¸€ä¸ªNVIDIA GPUã€‚ ç„¶åï¼Œä¸‹è½½<a href="https://developer.nvidia.com/cuda-downloads" target="_blank" rel="noreferrer">NVIDIAé©±åŠ¨å’ŒCUDA</a> å¹¶æŒ‰ç…§æç¤ºè®¾ç½®é€‚å½“çš„è·¯å¾„ã€‚ å½“è¿™äº›å‡†å¤‡å·¥ä½œå®Œæˆï¼Œå°±å¯ä»¥ä½¿ç”¨<code>nvidia-smi</code>å‘½ä»¤æ¥(<strong>æŸ¥çœ‹æ˜¾å¡ä¿¡æ¯ã€‚</strong>)</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab all</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nvidia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">smi</span></span></code></pre></div><p>:begin_tab:<code>mxnet</code> è¯»è€…å¯èƒ½å·²ç»æ³¨æ„åˆ°MXNetå¼ é‡çœ‹èµ·æ¥ä¸NumPyçš„<code>ndarray</code>å‡ ä¹ç›¸åŒã€‚ ä½†æœ‰ä¸€äº›å…³é”®åŒºåˆ«ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯MXNetæ”¯æŒä¸åŒçš„ç¡¬ä»¶è®¾å¤‡ã€‚</p><p>åœ¨MXNetä¸­ï¼Œæ¯ä¸ªæ•°ç»„éƒ½æœ‰ä¸€ä¸ªç¯å¢ƒï¼ˆcontextï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å˜é‡å’Œç›¸å…³çš„è®¡ç®—éƒ½åˆ†é…ç»™CPUã€‚ æœ‰æ—¶ç¯å¢ƒå¯èƒ½æ˜¯GPUã€‚ å½“æˆ‘ä»¬è·¨å¤šä¸ªæœåŠ¡å™¨éƒ¨ç½²ä½œä¸šæ—¶ï¼Œäº‹æƒ…ä¼šå˜å¾—æ›´åŠ æ£˜æ‰‹ã€‚ é€šè¿‡æ™ºèƒ½åœ°å°†æ•°ç»„åˆ†é…ç»™ç¯å¢ƒï¼Œ æˆ‘ä»¬å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘åœ¨è®¾å¤‡ä¹‹é—´ä¼ è¾“æ•°æ®çš„æ—¶é—´ã€‚ ä¾‹å¦‚ï¼Œå½“åœ¨å¸¦æœ‰GPUçš„æœåŠ¡å™¨ä¸Šè®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œ æˆ‘ä»¬é€šå¸¸å¸Œæœ›æ¨¡å‹çš„å‚æ•°åœ¨GPUä¸Šã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤æ˜¯å¦å®‰è£…äº†MXNetçš„GPUç‰ˆæœ¬ã€‚ å¦‚æœå·²ç»å®‰è£…äº†MXNetçš„CPUç‰ˆæœ¬ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¸è½½å®ƒã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨<code>pip uninstall mxnet</code>å‘½ä»¤ï¼Œ ç„¶åæ ¹æ®CUDAç‰ˆæœ¬å®‰è£…ç›¸åº”çš„MXNetçš„GPUç‰ˆæœ¬ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾å·²ç»å®‰è£…äº†CUDA10.0ï¼Œå¯ä»¥é€šè¿‡<code>pip install mxnet-cu100</code>å®‰è£…æ”¯æŒCUDA10.0çš„MXNetç‰ˆæœ¬ã€‚ :end_tab:</p><p>:begin_tab:<code>pytorch</code> åœ¨PyTorchä¸­ï¼Œæ¯ä¸ªæ•°ç»„éƒ½æœ‰ä¸€ä¸ªè®¾å¤‡ï¼ˆdeviceï¼‰ï¼Œ æˆ‘ä»¬é€šå¸¸å°†å…¶ç§°ä¸ºç¯å¢ƒï¼ˆcontextï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å˜é‡å’Œç›¸å…³çš„è®¡ç®—éƒ½åˆ†é…ç»™CPUã€‚ æœ‰æ—¶ç¯å¢ƒå¯èƒ½æ˜¯GPUã€‚ å½“æˆ‘ä»¬è·¨å¤šä¸ªæœåŠ¡å™¨éƒ¨ç½²ä½œä¸šæ—¶ï¼Œäº‹æƒ…ä¼šå˜å¾—æ›´åŠ æ£˜æ‰‹ã€‚ é€šè¿‡æ™ºèƒ½åœ°å°†æ•°ç»„åˆ†é…ç»™ç¯å¢ƒï¼Œ æˆ‘ä»¬å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘åœ¨è®¾å¤‡ä¹‹é—´ä¼ è¾“æ•°æ®çš„æ—¶é—´ã€‚ ä¾‹å¦‚ï¼Œå½“åœ¨å¸¦æœ‰GPUçš„æœåŠ¡å™¨ä¸Šè®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œ æˆ‘ä»¬é€šå¸¸å¸Œæœ›æ¨¡å‹çš„å‚æ•°åœ¨GPUä¸Šã€‚ :end_tab:</p><p>:begin_tab:<code>paddle</code> åœ¨PaddlePaddleä¸­ï¼Œæ¯ä¸ªå¼ é‡éƒ½æœ‰ä¸€ä¸ªè®¾å¤‡ï¼ˆdeviceï¼‰ï¼Œ æˆ‘ä»¬é€šå¸¸å°†å…¶ç§°ä¸ºä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å˜é‡å’Œç›¸å…³çš„è®¡ç®—éƒ½åˆ†é…ç»™CPUã€‚ æœ‰æ—¶ä¸Šä¸‹æ–‡å¯èƒ½æ˜¯GPUã€‚ å½“æˆ‘ä»¬è·¨å¤šä¸ªæœåŠ¡å™¨éƒ¨ç½²ä½œä¸šæ—¶ï¼Œäº‹æƒ…ä¼šå˜å¾—æ›´åŠ æ£˜æ‰‹ã€‚ é€šè¿‡æ™ºèƒ½åœ°å°†æ•°ç»„åˆ†é…ç»™ä¸Šä¸‹æ–‡ï¼Œ æˆ‘ä»¬å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘åœ¨è®¾å¤‡ä¹‹é—´ä¼ è¾“æ•°æ®çš„æ—¶é—´ã€‚ ä¾‹å¦‚ï¼Œå½“åœ¨å¸¦æœ‰GPUçš„æœåŠ¡å™¨ä¸Šè®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œ æˆ‘ä»¬é€šå¸¸å¸Œæœ›æ¨¡å‹çš„å‚æ•°åœ¨GPUä¸Šã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤å®‰è£…äº†PaddlePaddleçš„GPUç‰ˆæœ¬ã€‚ å¦‚æœå·²ç»å®‰è£…äº†PaddlePaddleçš„CPUç‰ˆæœ¬ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¸è½½å®ƒã€‚ ç„¶åæ ¹æ®ä½ çš„CUDAç‰ˆæœ¬å®‰è£…ç›¸åº”çš„PaddlePaddleçš„GPUç‰ˆæœ¬ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ä½ å®‰è£…äº†CUDA10.1ï¼Œä½ å¯ä»¥é€šè¿‡<code>conda install paddlepaddle-gpu==2.2.2 cudatoolkit=10.1 --channel https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/Paddle/</code>å®‰è£…æ”¯æŒCUDA10.1çš„PaddlePaddleç‰ˆæœ¬ã€‚ :end_tab:</p><p>è¦è¿è¡Œæ­¤éƒ¨åˆ†ä¸­çš„ç¨‹åºï¼Œè‡³å°‘éœ€è¦ä¸¤ä¸ªGPUã€‚ æ³¨æ„ï¼Œå¯¹å¤§å¤šæ•°æ¡Œé¢è®¡ç®—æœºæ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯å¥¢ä¾ˆçš„ï¼Œä½†åœ¨äº‘ä¸­å¾ˆå®¹æ˜“è·å¾—ã€‚ ä¾‹å¦‚å¯ä»¥ä½¿ç”¨AWS EC2çš„å¤šGPUå®ä¾‹ã€‚ æœ¬ä¹¦çš„å…¶ä»–ç« èŠ‚å¤§éƒ½ä¸éœ€è¦å¤šä¸ªGPUï¼Œ è€Œæœ¬èŠ‚åªæ˜¯ä¸ºäº†å±•ç¤ºæ•°æ®å¦‚ä½•åœ¨ä¸åŒçš„è®¾å¤‡ä¹‹é—´ä¼ é€’ã€‚</p><h2 id="è®¡ç®—è®¾å¤‡" tabindex="-1">[<strong>è®¡ç®—è®¾å¤‡</strong>] <a class="header-anchor" href="#è®¡ç®—è®¾å¤‡" aria-label="Permalink to &quot;[**è®¡ç®—è®¾å¤‡**]&quot;">â€‹</a></h2><p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šç”¨äºå­˜å‚¨å’Œè®¡ç®—çš„è®¾å¤‡ï¼Œå¦‚CPUå’ŒGPUã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼ é‡æ˜¯åœ¨å†…å­˜ä¸­åˆ›å»ºçš„ï¼Œç„¶åä½¿ç”¨CPUè®¡ç®—å®ƒã€‚</p>`,15)),i("p",null,[s[4]||(s[4]=a(":begin_tab:",-1)),s[5]||(s[5]=i("code",null,"mxnet",-1)),s[6]||(s[6]=a(" åœ¨MXNetä¸­ï¼ŒCPUå’ŒGPUå¯ä»¥ç”¨",-1)),s[7]||(s[7]=i("code",null,"cpu()",-1)),s[8]||(s[8]=a("å’Œ",-1)),s[9]||(s[9]=i("code",null,"gpu()",-1)),s[10]||(s[10]=a("è¡¨ç¤ºã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ",-1)),s[11]||(s[11]=i("code",null,"cpu()",-1)),s[12]||(s[12]=a("ï¼ˆæˆ–æ‹¬å·ä¸­çš„ä»»æ„æ•´æ•°ï¼‰è¡¨ç¤ºæ‰€æœ‰ç‰©ç†CPUå’Œå†…å­˜ï¼Œ è¿™æ„å‘³ç€MXNetçš„è®¡ç®—å°†å°è¯•ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒã€‚ ç„¶è€Œï¼Œ",-1)),s[13]||(s[13]=i("code",null,"gpu()",-1)),s[14]||(s[14]=a("åªä»£è¡¨ä¸€ä¸ªå¡å’Œç›¸åº”çš„æ˜¾å­˜ã€‚ å¦‚æœæœ‰å¤šä¸ªGPUï¼Œæˆ‘ä»¬ä½¿ç”¨",-1)),s[15]||(s[15]=i("code",null,"gpu(i)",-1)),s[16]||(s[16]=a("è¡¨ç¤ºç¬¬",-1)),i("mjx-container",k,[(t(),n("svg",d,[...s[0]||(s[0]=[i("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[i("g",{"data-mml-node":"math"},[i("g",{"data-mml-node":"mi"},[i("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),s[1]||(s[1]=i("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("mi",null,"i")])],-1))]),s[17]||(s[17]=a("å—GPUï¼ˆ",-1)),i("mjx-container",r,[(t(),n("svg",E,[...s[2]||(s[2]=[i("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[i("g",{"data-mml-node":"math"},[i("g",{"data-mml-node":"mi"},[i("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),s[3]||(s[3]=i("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("mi",null,"i")])],-1))]),s[18]||(s[18]=a("ä»0å¼€å§‹ï¼‰ã€‚ å¦å¤–ï¼Œ",-1)),s[19]||(s[19]=i("code",null,"gpu(0)",-1)),s[20]||(s[20]=a("å’Œ",-1)),s[21]||(s[21]=i("code",null,"gpu()",-1)),s[22]||(s[22]=a("æ˜¯ç­‰ä»·çš„ã€‚ :end_tab:",-1))]),i("p",null,[s[27]||(s[27]=a(":begin_tab:",-1)),s[28]||(s[28]=i("code",null,"pytorch",-1)),s[29]||(s[29]=a(" åœ¨PyTorchä¸­ï¼ŒCPUå’ŒGPUå¯ä»¥ç”¨",-1)),s[30]||(s[30]=i("code",null,"torch.device('cpu')",-1)),s[31]||(s[31]=a(" å’Œ",-1)),s[32]||(s[32]=i("code",null,"torch.device('cuda')",-1)),s[33]||(s[33]=a("è¡¨ç¤ºã€‚ åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œ",-1)),s[34]||(s[34]=i("code",null,"cpu",-1)),s[35]||(s[35]=a("è®¾å¤‡æ„å‘³ç€æ‰€æœ‰ç‰©ç†CPUå’Œå†…å­˜ï¼Œ è¿™æ„å‘³ç€PyTorchçš„è®¡ç®—å°†å°è¯•ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒã€‚ ç„¶è€Œï¼Œ",-1)),s[36]||(s[36]=i("code",null,"gpu",-1)),s[37]||(s[37]=a("è®¾å¤‡åªä»£è¡¨ä¸€ä¸ªå¡å’Œç›¸åº”çš„æ˜¾å­˜ã€‚ å¦‚æœæœ‰å¤šä¸ªGPUï¼Œæˆ‘ä»¬ä½¿ç”¨",-1)),s[38]||(s[38]=i("code",null,"torch.device(f'cuda:{i}')",-1)),s[39]||(s[39]=a(" æ¥è¡¨ç¤ºç¬¬",-1)),i("mjx-container",o,[(t(),n("svg",g,[...s[23]||(s[23]=[i("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[i("g",{"data-mml-node":"math"},[i("g",{"data-mml-node":"mi"},[i("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),s[24]||(s[24]=i("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("mi",null,"i")])],-1))]),s[40]||(s[40]=a("å—GPUï¼ˆ",-1)),i("mjx-container",y,[(t(),n("svg",c,[...s[25]||(s[25]=[i("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[i("g",{"data-mml-node":"math"},[i("g",{"data-mml-node":"mi"},[i("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1)])])),s[26]||(s[26]=i("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("mi",null,"i")])],-1))]),s[41]||(s[41]=a("ä»0å¼€å§‹ï¼‰ã€‚ å¦å¤–ï¼Œ",-1)),s[42]||(s[42]=i("code",null,"cuda:0",-1)),s[43]||(s[43]=a("å’Œ",-1)),s[44]||(s[44]=i("code",null,"cuda",-1)),s[45]||(s[45]=a("æ˜¯ç­‰ä»·çš„ã€‚ :end_tab:",-1))]),s[54]||(s[54]=p(`<p>:begin_tab:<code>paddle</code> åœ¨é£æ¡¨ä¸­ï¼ŒCPUå’ŒGPUå¯ä»¥ç”¨<code>paddle.device.set_device(&#39;cpu&#39;)</code> å’Œ<code>paddle.device.set_device(&#39;gpu&#39;)</code>è¡¨ç¤ºã€‚ åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œ<code>cpu</code>è®¾å¤‡æ„å‘³ç€æ‰€æœ‰ç‰©ç†CPUå’Œå†…å­˜, è¿™æ„å‘³ç€é£æ¡¨çš„è®¡ç®—å°†å°è¯•ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒã€‚ ç„¶è€Œï¼Œ<code>gpu</code>è®¾å¤‡åªä»£è¡¨ä¸€ä¸ªå¡å’Œç›¸åº”çš„æ˜¾å­˜ã€‚ å¦‚æœæœ‰å¤šä¸ªGPUï¼Œæˆ‘ä»¬ä½¿ç”¨<code>paddle.device.get_device()</code> å…¶ä¸­è¾“å‡ºçš„æ•°å­—æ˜¯è¡¨ç¤ºçš„æ˜¯å¡å·ï¼ˆæ¯”å¦‚<code>gpu:3</code>ï¼Œè¡¨ç¤ºçš„æ˜¯å¡3ï¼Œæ³¨æ„GPUçš„å¡å·æ˜¯ä»0å¼€å§‹çš„ï¼‰ã€‚ å¦å¤–ï¼Œ<code>gpu:0</code>å’Œ<code>gpu</code>æ˜¯ç­‰ä»·çš„ã€‚ :end_tab:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mxnet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np, npx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mxnet.gluon </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npx.set_np()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npx.cpu(), npx.gpu(), npx.gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">torch.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cpu&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), torch.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cuda&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), torch.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cuda:1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tensorflow </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tf.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/CPU:0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), tf.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/GPU:0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), tf.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/GPU:1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">paddle.device.set_device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cpu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), paddle.CUDAPlace(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), paddle.CUDAPlace(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥(<strong>æŸ¥è¯¢å¯ç”¨gpuçš„æ•°é‡ã€‚</strong>)</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npx.num_gpus()</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">torch.cuda.device_count()</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tf.config.experimental.list_physical_devices(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;GPU&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">paddle.device.cuda.device_count()</span></span></code></pre></div><p>ç°åœ¨æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ–¹ä¾¿çš„å‡½æ•°ï¼Œ [<strong>è¿™ä¸¤ä¸ªå‡½æ•°å…è®¸æˆ‘ä»¬åœ¨ä¸å­˜åœ¨æ‰€éœ€æ‰€æœ‰GPUçš„æƒ…å†µä¸‹è¿è¡Œä»£ç ã€‚</strong>]</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_gpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;å¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›gpu(i)ï¼Œå¦åˆ™è¿”å›cpu()&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npx.gpu(i) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npx.num_gpus() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npx.cpu()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_all_gpus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;è¿”å›æ‰€æœ‰å¯ç”¨çš„GPUï¼Œå¦‚æœæ²¡æœ‰GPUï¼Œåˆ™è¿”å›[cpu()]&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [npx.gpu(i) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(npx.num_gpus())]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [npx.cpu()]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu(), try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), try_all_gpus()</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_gpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;å¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›gpu(i)ï¼Œå¦åˆ™è¿”å›cpu()&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.cuda.device_count() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.device(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cuda:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cpu&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_all_gpus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;è¿”å›æ‰€æœ‰å¯ç”¨çš„GPUï¼Œå¦‚æœæ²¡æœ‰GPUï¼Œåˆ™è¿”å›[cpu(),]&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [torch.device(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cuda:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">             for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(torch.cuda.device_count())]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [torch.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cpu&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu(), try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), try_all_gpus()</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_gpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;å¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›gpu(i)ï¼Œå¦åˆ™è¿”å›cpu()&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tf.config.experimental.list_physical_devices(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;GPU&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf.device(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/GPU:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/CPU:0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_all_gpus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;è¿”å›æ‰€æœ‰å¯ç”¨çš„GPUï¼Œå¦‚æœæ²¡æœ‰GPUï¼Œåˆ™è¿”å›[cpu(),]&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    num_gpus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tf.config.experimental.list_physical_devices(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;GPU&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [tf.device(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/GPU:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(num_gpus)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [tf.device(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/CPU:0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu(), try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), try_all_gpus()</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_gpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;å¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›gpu(i)ï¼Œå¦åˆ™è¿”å›cpu()ã€‚&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle.device.cuda.device_count() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle.CUDAPlace(i)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle.CPUPlace()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@save</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_all_gpus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;è¿”å›æ‰€æœ‰å¯ç”¨çš„GPUï¼Œå¦‚æœæ²¡æœ‰GPUï¼Œåˆ™è¿”å›[cpu(),]ã€‚&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [paddle.CUDAPlace(i)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">               for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(paddle.device.cuda.device_count())]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> devices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle.CPUPlace()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu(),try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),try_all_gpus()</span></span></code></pre></div><h2 id="å¼ é‡ä¸gpu" tabindex="-1">å¼ é‡ä¸GPU <a class="header-anchor" href="#å¼ é‡ä¸gpu" aria-label="Permalink to &quot;å¼ é‡ä¸GPU&quot;">â€‹</a></h2><p>æˆ‘ä»¬å¯ä»¥[<strong>æŸ¥è¯¢å¼ é‡æ‰€åœ¨çš„è®¾å¤‡ã€‚</strong>] é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼ é‡æ˜¯åœ¨CPUä¸Šåˆ›å»ºçš„ã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.array([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x.ctx</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.tensor([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x.device</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf.constant([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x.device</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle.to_tensor([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x.place</span></span></code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºä½•æ—¶æˆ‘ä»¬è¦å¯¹å¤šä¸ªé¡¹è¿›è¡Œæ“ä½œï¼Œ å®ƒä»¬éƒ½å¿…é¡»åœ¨åŒä¸€ä¸ªè®¾å¤‡ä¸Šã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å¯¹ä¸¤ä¸ªå¼ é‡æ±‚å’Œï¼Œ æˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸¤ä¸ªå¼ é‡éƒ½ä½äºåŒä¸€ä¸ªè®¾å¤‡ä¸Šï¼Œ å¦åˆ™æ¡†æ¶å°†ä¸çŸ¥é“åœ¨å“ªé‡Œå­˜å‚¨ç»“æœï¼Œç”šè‡³ä¸çŸ¥é“åœ¨å“ªé‡Œæ‰§è¡Œè®¡ç®—ã€‚</p><h3 id="å­˜å‚¨åœ¨gpuä¸Š" tabindex="-1">[<strong>å­˜å‚¨åœ¨GPUä¸Š</strong>] <a class="header-anchor" href="#å­˜å‚¨åœ¨gpuä¸Š" aria-label="Permalink to &quot;[**å­˜å‚¨åœ¨GPUä¸Š**]&quot;">â€‹</a></h3><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åœ¨GPUä¸Šå­˜å‚¨å¼ é‡ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºå¼ é‡æ—¶æŒ‡å®šå­˜å‚¨è®¾å¤‡ã€‚æ¥ ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ª<code>gpu</code>ä¸Šåˆ›å»ºå¼ é‡å˜é‡<code>X</code>ã€‚ åœ¨GPUä¸Šåˆ›å»ºçš„å¼ é‡åªæ¶ˆè€—è¿™ä¸ªGPUçš„æ˜¾å­˜ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>nvidia-smi</code>å‘½ä»¤æŸ¥çœ‹æ˜¾å­˜ä½¿ç”¨æƒ…å†µã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸åˆ›å»ºè¶…è¿‡GPUæ˜¾å­˜é™åˆ¶çš„æ•°æ®ã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.ones((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.ones(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> try_gpu():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf.ones((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle.to_tensor(paddle.ones(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shape</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">place</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X</span></span></code></pre></div><p>å‡è®¾æˆ‘ä»¬è‡³å°‘æœ‰ä¸¤ä¸ªGPUï¼Œä¸‹é¢çš„ä»£ç å°†åœ¨(<strong>ç¬¬äºŒä¸ªGPUä¸Šåˆ›å»ºä¸€ä¸ªéšæœºå¼ é‡ã€‚</strong>)</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.random.uniform(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.rand(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf.random.uniform((</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> paddle.to_tensor(paddle.rand([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">place</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y</span></span></code></pre></div><h3 id="å¤åˆ¶" tabindex="-1">å¤åˆ¶ <a class="header-anchor" href="#å¤åˆ¶" aria-label="Permalink to &quot;å¤åˆ¶&quot;">â€‹</a></h3><p>å¦‚æœæˆ‘ä»¬[<strong>è¦è®¡ç®—<code>X + Y</code>ï¼Œæˆ‘ä»¬éœ€è¦å†³å®šåœ¨å“ªé‡Œæ‰§è¡Œè¿™ä¸ªæ“ä½œ</strong>]ã€‚ ä¾‹å¦‚ï¼Œå¦‚ :numref:<code>fig_copyto</code>æ‰€ç¤ºï¼Œ æˆ‘ä»¬å¯ä»¥å°†<code>X</code>ä¼ è¾“åˆ°ç¬¬äºŒä¸ªGPUå¹¶åœ¨é‚£é‡Œæ‰§è¡Œæ“ä½œã€‚ <em>ä¸è¦</em>ç®€å•åœ°<code>X</code>åŠ ä¸Š<code>Y</code>ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´å¼‚å¸¸ï¼Œ è¿è¡Œæ—¶å¼•æ“ä¸çŸ¥é“è¯¥æ€ä¹ˆåšï¼šå®ƒåœ¨åŒä¸€è®¾å¤‡ä¸Šæ‰¾ä¸åˆ°æ•°æ®ä¼šå¯¼è‡´å¤±è´¥ã€‚ ç”±äº<code>Y</code>ä½äºç¬¬äºŒä¸ªGPUä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†<code>X</code>ç§»åˆ°é‚£é‡Œï¼Œ ç„¶åæ‰èƒ½æ‰§è¡Œç›¸åŠ è¿ç®—ã€‚</p><p><img src="`+h+`" alt="å¤åˆ¶æ•°æ®ä»¥åœ¨åŒä¸€è®¾å¤‡ä¸Šæ‰§è¡Œæ“ä½œ"> ğŸ·ï¸<code>fig_copyto</code></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> X.copyto(try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Z)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch, paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> X.cuda(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Z)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> X</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Z)</span></span></code></pre></div><p>[<strong>ç°åœ¨æ•°æ®åœ¨åŒä¸€ä¸ªGPUä¸Šï¼ˆ<code>Z</code>å’Œ<code>Y</code>éƒ½åœ¨ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ç›¸åŠ ã€‚</strong>]</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab all</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Z</span></span></code></pre></div><p>:begin_tab:<code>mxnet</code> å‡è®¾å˜é‡<code>Z</code>å·²ç»å­˜åœ¨äºç¬¬äºŒä¸ªGPUä¸Šã€‚ å¦‚æœç°åœ¨æˆ‘ä»¬è¿˜æ˜¯è°ƒç”¨<code>Z.copyto(gpu(1))</code>ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å³ä½¿è¯¥å˜é‡å·²ç»å­˜åœ¨äºç›®æ ‡è®¾å¤‡ï¼ˆç¬¬äºŒä¸ªGPUï¼‰ä¸Šï¼Œ å®ƒä»å°†è¢«å¤åˆ¶å¹¶ä¿å­˜åœ¨æ–°åˆ†é…çš„æ˜¾å­˜ä¸­ã€‚ æœ‰æ—¶ï¼Œæˆ‘ä»¬åªæƒ³åœ¨å˜é‡å­˜åœ¨äºä¸åŒè®¾å¤‡ä¸­æ—¶è¿›è¡Œå¤åˆ¶ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨<code>as_in_ctx</code>ã€‚ å¦‚æœå˜é‡å·²ç»å­˜åœ¨äºæŒ‡å®šçš„è®¾å¤‡ä¸­ï¼Œåˆ™è¿™ä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œã€‚ é™¤éæˆ‘ä»¬ç‰¹åˆ«æƒ³åˆ›å»ºä¸€ä¸ªå¤åˆ¶ï¼Œå¦åˆ™é€‰æ‹©<code>as_in_ctx</code>æ–¹æ³•ã€‚ :end_tab:</p><p>:begin_tab:<code>pytorch</code> å‡è®¾å˜é‡<code>Z</code>å·²ç»å­˜åœ¨äºç¬¬äºŒä¸ªGPUä¸Šã€‚ å¦‚æœæˆ‘ä»¬è¿˜æ˜¯è°ƒç”¨<code>Z.cuda(1)</code>ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å®ƒå°†è¿”å›<code>Z</code>ï¼Œè€Œä¸ä¼šå¤åˆ¶å¹¶åˆ†é…æ–°å†…å­˜ã€‚ :end_tab:</p><p>:begin_tab:<code>tensorflow</code> å‡è®¾å˜é‡<code>Z</code>å·²ç»å­˜åœ¨äºç¬¬äºŒä¸ªGPUä¸Šã€‚ å¦‚æœæˆ‘ä»¬ä»ç„¶åœ¨åŒä¸€ä¸ªè®¾å¤‡ä½œç”¨åŸŸä¸‹è°ƒç”¨<code>Z2 = Z</code>ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å®ƒå°†è¿”å›<code>Z</code>ï¼Œè€Œä¸ä¼šå¤åˆ¶å¹¶åˆ†é…æ–°å†…å­˜ã€‚ :end_tab:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Z.as_in_ctx(try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Z</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch, paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Z.cuda(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Z</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> try_gpu(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Z2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Z</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Z2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Z</span></span></code></pre></div><h3 id="æ—æ³¨" tabindex="-1">æ—æ³¨ <a class="header-anchor" href="#æ—æ³¨" aria-label="Permalink to &quot;æ—æ³¨&quot;">â€‹</a></h3><p>äººä»¬ä½¿ç”¨GPUæ¥è¿›è¡Œæœºå™¨å­¦ä¹ ï¼Œå› ä¸ºå•ä¸ªGPUç›¸å¯¹è¿è¡Œé€Ÿåº¦å¿«ã€‚ ä½†æ˜¯åœ¨è®¾å¤‡ï¼ˆCPUã€GPUå’Œå…¶ä»–æœºå™¨ï¼‰ä¹‹é—´ä¼ è¾“æ•°æ®æ¯”è®¡ç®—æ…¢å¾—å¤šã€‚ è¿™ä¹Ÿä½¿å¾—å¹¶è¡ŒåŒ–å˜å¾—æ›´åŠ å›°éš¾ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»ç­‰å¾…æ•°æ®è¢«å‘é€ï¼ˆæˆ–è€…æ¥æ”¶ï¼‰ï¼Œ ç„¶åæ‰èƒ½ç»§ç»­è¿›è¡Œæ›´å¤šçš„æ“ä½œã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‹·è´æ“ä½œè¦æ ¼å¤–å°å¿ƒã€‚ æ ¹æ®ç»éªŒï¼Œå¤šä¸ªå°æ“ä½œæ¯”ä¸€ä¸ªå¤§æ“ä½œç³Ÿç³•å¾—å¤šã€‚ æ­¤å¤–ï¼Œä¸€æ¬¡æ‰§è¡Œå‡ ä¸ªæ“ä½œæ¯”ä»£ç ä¸­æ•£å¸ƒçš„è®¸å¤šå•ä¸ªæ“ä½œè¦å¥½å¾—å¤šã€‚ å¦‚æœä¸€ä¸ªè®¾å¤‡å¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªè®¾å¤‡æ‰èƒ½æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œ é‚£ä¹ˆè¿™æ ·çš„æ“ä½œå¯èƒ½ä¼šé˜»å¡ã€‚ è¿™æœ‰ç‚¹åƒæ’é˜Ÿè®¢è´­å’–å•¡ï¼Œè€Œä¸åƒé€šè¿‡ç”µè¯é¢„å…ˆè®¢è´­ï¼š å½“å®¢äººåˆ°åº—çš„æ—¶å€™ï¼Œå’–å•¡å·²ç»å‡†å¤‡å¥½äº†ã€‚</p><p>æœ€åï¼Œå½“æˆ‘ä»¬æ‰“å°å¼ é‡æˆ–å°†å¼ é‡è½¬æ¢ä¸ºNumPyæ ¼å¼æ—¶ï¼Œ å¦‚æœæ•°æ®ä¸åœ¨å†…å­˜ä¸­ï¼Œæ¡†æ¶ä¼šé¦–å…ˆå°†å…¶å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œ è¿™ä¼šå¯¼è‡´é¢å¤–çš„ä¼ è¾“å¼€é”€ã€‚ æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå®ƒç°åœ¨å—åˆ¶äºå…¨å±€è§£é‡Šå™¨é”ï¼Œä½¿å¾—ä¸€åˆ‡éƒ½å¾—ç­‰å¾…Pythonå®Œæˆã€‚</p><h2 id="ç¥ç»ç½‘ç»œä¸gpu" tabindex="-1">[<strong>ç¥ç»ç½‘ç»œä¸GPU</strong>] <a class="header-anchor" href="#ç¥ç»ç½‘ç»œä¸gpu" aria-label="Permalink to &quot;[**ç¥ç»ç½‘ç»œä¸GPU**]&quot;">â€‹</a></h2><p>ç±»ä¼¼åœ°ï¼Œç¥ç»ç½‘ç»œæ¨¡å‹å¯ä»¥æŒ‡å®šè®¾å¤‡ã€‚ ä¸‹é¢çš„ä»£ç å°†æ¨¡å‹å‚æ•°æ”¾åœ¨GPUä¸Šã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn.Sequential()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net.add(nn.Dense(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net.initialize(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu())</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn.Sequential(nn.Linear(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> net.to(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try_gpu())</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">strategy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf.distribute.MirroredStrategy()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strategy.scope():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tf.keras.models.Sequential([</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        tf.keras.layers.Dense(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)])</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn.Sequential(nn.Linear(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net.to(try_gpu())</span></span></code></pre></div><p>åœ¨æ¥ä¸‹æ¥çš„å‡ ç« ä¸­ï¼Œ æˆ‘ä»¬å°†çœ‹åˆ°æ›´å¤šå…³äºå¦‚ä½•åœ¨GPUä¸Šè¿è¡Œæ¨¡å‹çš„ä¾‹å­ï¼Œ å› ä¸ºå®ƒä»¬å°†å˜å¾—æ›´åŠ è®¡ç®—å¯†é›†ã€‚</p><p>å½“è¾“å…¥ä¸ºGPUä¸Šçš„å¼ é‡æ—¶ï¼Œæ¨¡å‹å°†åœ¨åŒä¸€GPUä¸Šè®¡ç®—ç»“æœã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab all</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net(X)</span></span></code></pre></div><p>è®©æˆ‘ä»¬(<strong>ç¡®è®¤æ¨¡å‹å‚æ•°å­˜å‚¨åœ¨åŒä¸€ä¸ªGPUä¸Šã€‚</strong>)</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].weight.data().ctx</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab pytorch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].weight.data.device</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab tensorflow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net.layers[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].weights[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].device, net.layers[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].weights[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].device</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#@tab paddle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">net[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].weight.place</span></span></code></pre></div><p>æ€»ä¹‹ï¼Œåªè¦æ‰€æœ‰çš„æ•°æ®å’Œå‚æ•°éƒ½åœ¨åŒä¸€ä¸ªè®¾å¤‡ä¸Šï¼Œ æˆ‘ä»¬å°±å¯ä»¥æœ‰æ•ˆåœ°å­¦ä¹ æ¨¡å‹ã€‚ åœ¨ä¸‹é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å‡ ä¸ªè¿™æ ·çš„ä¾‹å­ã€‚</p><h2 id="å°ç»“" tabindex="-1">å°ç»“ <a class="header-anchor" href="#å°ç»“" aria-label="Permalink to &quot;å°ç»“&quot;">â€‹</a></h2><ul><li>æˆ‘ä»¬å¯ä»¥æŒ‡å®šç”¨äºå­˜å‚¨å’Œè®¡ç®—çš„è®¾å¤‡ï¼Œä¾‹å¦‚CPUæˆ–GPUã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®åœ¨ä¸»å†…å­˜ä¸­åˆ›å»ºï¼Œç„¶åä½¿ç”¨CPUè¿›è¡Œè®¡ç®—ã€‚</li><li>æ·±åº¦å­¦ä¹ æ¡†æ¶è¦æ±‚è®¡ç®—çš„æ‰€æœ‰è¾“å…¥æ•°æ®éƒ½åœ¨åŒä¸€è®¾å¤‡ä¸Šï¼Œæ— è®ºæ˜¯CPUè¿˜æ˜¯GPUã€‚</li><li>ä¸ç»æ„åœ°ç§»åŠ¨æ•°æ®å¯èƒ½ä¼šæ˜¾è‘—é™ä½æ€§èƒ½ã€‚ä¸€ä¸ªå…¸å‹çš„é”™è¯¯å¦‚ä¸‹ï¼šè®¡ç®—GPUä¸Šæ¯ä¸ªå°æ‰¹é‡çš„æŸå¤±ï¼Œå¹¶åœ¨å‘½ä»¤è¡Œä¸­å°†å…¶æŠ¥å‘Šç»™ç”¨æˆ·ï¼ˆæˆ–å°†å…¶è®°å½•åœ¨NumPy <code>ndarray</code>ä¸­ï¼‰æ—¶ï¼Œå°†è§¦å‘å…¨å±€è§£é‡Šå™¨é”ï¼Œä»è€Œä½¿æ‰€æœ‰GPUé˜»å¡ã€‚æœ€å¥½æ˜¯ä¸ºGPUå†…éƒ¨çš„æ—¥å¿—åˆ†é…å†…å­˜ï¼Œå¹¶ä¸”åªç§»åŠ¨è¾ƒå¤§çš„æ—¥å¿—ã€‚</li></ul><h2 id="ç»ƒä¹ " tabindex="-1">ç»ƒä¹  <a class="header-anchor" href="#ç»ƒä¹ " aria-label="Permalink to &quot;ç»ƒä¹ &quot;">â€‹</a></h2>`,68)),i("ol",null,[s[50]||(s[50]=i("li",null,"å°è¯•ä¸€ä¸ªè®¡ç®—é‡æ›´å¤§çš„ä»»åŠ¡ï¼Œæ¯”å¦‚å¤§çŸ©é˜µçš„ä¹˜æ³•ï¼Œçœ‹çœ‹CPUå’ŒGPUä¹‹é—´çš„é€Ÿåº¦å·®å¼‚ã€‚å†è¯•ä¸€ä¸ªè®¡ç®—é‡å¾ˆå°çš„ä»»åŠ¡å‘¢ï¼Ÿ",-1)),s[51]||(s[51]=i("li",null,"æˆ‘ä»¬åº”è¯¥å¦‚ä½•åœ¨GPUä¸Šè¯»å†™æ¨¡å‹å‚æ•°ï¼Ÿ",-1)),i("li",null,[s[48]||(s[48]=a("æµ‹é‡è®¡ç®—1000ä¸ª",-1)),i("mjx-container",u,[(t(),n("svg",F,[...s[46]||(s[46]=[p('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1722.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(2722.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width:3;"></path></g></g></g>',1)])])),s[47]||(s[47]=i("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("mn",null,"100"),i("mo",null,"Ã—"),i("mn",null,"100")])],-1))]),s[49]||(s[49]=a("çŸ©é˜µçš„çŸ©é˜µä¹˜æ³•æ‰€éœ€çš„æ—¶é—´ï¼Œå¹¶è®°å½•è¾“å‡ºçŸ©é˜µçš„FrobeniusèŒƒæ•°ï¼Œä¸€æ¬¡è®°å½•ä¸€ä¸ªç»“æœï¼Œè€Œä¸æ˜¯åœ¨GPUä¸Šä¿å­˜æ—¥å¿—å¹¶ä»…ä¼ è¾“æœ€ç»ˆç»“æœã€‚",-1))]),s[52]||(s[52]=i("li",null,"æµ‹é‡åŒæ—¶åœ¨ä¸¤ä¸ªGPUä¸Šæ‰§è¡Œä¸¤ä¸ªçŸ©é˜µä¹˜æ³•ä¸åœ¨ä¸€ä¸ªGPUä¸ŠæŒ‰é¡ºåºæ‰§è¡Œä¸¤ä¸ªçŸ©é˜µä¹˜æ³•æ‰€éœ€çš„æ—¶é—´ã€‚æç¤ºï¼šåº”è¯¥çœ‹åˆ°è¿‘ä¹çº¿æ€§çš„ç¼©æ”¾ã€‚",-1))]),s[55]||(s[55]=p('<p>:begin_tab:<code>mxnet</code><a href="https://discuss.d2l.ai/t/1843" target="_blank" rel="noreferrer">Discussions</a> :end_tab:</p><p>:begin_tab:<code>pytorch</code><a href="https://discuss.d2l.ai/t/1841" target="_blank" rel="noreferrer">Discussions</a> :end_tab:</p><p>:begin_tab:<code>tensorflow</code><a href="https://discuss.d2l.ai/t/1842" target="_blank" rel="noreferrer">Discussions</a> :end_tab:</p><p>:begin_tab:<code>paddle</code><a href="https://discuss.d2l.ai/t/11782" target="_blank" rel="noreferrer">Discussions</a> :end_tab:</p>',4))])}const Q=l(e,[["render",C]]);export{T as __pageData,Q as default};
