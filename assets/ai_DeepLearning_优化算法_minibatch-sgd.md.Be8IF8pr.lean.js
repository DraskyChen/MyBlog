import{_ as h,c as n,o as l,ag as t,j as s,a}from"./chunks/framework.C2Gjomh7.js";const Fs=JSON.parse('{"title":"小批量随机梯度下降","description":"","frontmatter":{},"headers":[],"relativePath":"ai/DeepLearning/优化算法/minibatch-sgd.md","filePath":"ai/DeepLearning/优化算法/minibatch-sgd.md","lastUpdated":1756829839000}'),p={name:"ai/DeepLearning/优化算法/minibatch-sgd.md"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"20.877ex",height:"2.14ex",role:"img",focusable:"false",viewBox:"0 -864 9227.5 946","aria-hidden":"true"},r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.714ex",height:"1.765ex",role:"img",focusable:"false",viewBox:"0 -698 3851.6 780","aria-hidden":"true"},E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.966ex",height:"1.579ex",role:"img",focusable:"false",viewBox:"0 -698 869 698","aria-hidden":"true"},o={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.478ex",height:"2.86ex",role:"img",focusable:"false",viewBox:"0 -835.3 5957.4 1264","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.97ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.187ex",height:"2.86ex",role:"img",focusable:"false",viewBox:"0 -835.3 5386.5 1264","aria-hidden":"true"},T={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.966ex",height:"1.579ex",role:"img",focusable:"false",viewBox:"0 -698 869 698","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.595ex",height:"2.229ex",role:"img",focusable:"false",viewBox:"0 -698 1589.1 985.2","aria-hidden":"true"},A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.714ex",height:"1.765ex",role:"img",focusable:"false",viewBox:"0 -698 3851.6 780","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.851ex",height:"1.552ex",role:"img",focusable:"false",viewBox:"0 -686 818 686","aria-hidden":"true"},w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.88ex",height:"1.602ex",role:"img",focusable:"false",viewBox:"0 -697 831 708","aria-hidden":"true"},B={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.966ex",height:"1.579ex",role:"img",focusable:"false",viewBox:"0 -698 869 698","aria-hidden":"true"},_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.365ex",height:"2.245ex",role:"img",focusable:"false",viewBox:"0 -698 1487.3 992.2","aria-hidden":"true"},H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.851ex",height:"1.552ex",role:"img",focusable:"false",viewBox:"0 -686 818 686","aria-hidden":"true"},L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.616ex",height:"2.243ex",role:"img",focusable:"false",viewBox:"0 -697 1598.5 991.2","aria-hidden":"true"},j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.851ex",height:"1.552ex",role:"img",focusable:"false",viewBox:"0 -686 818 686","aria-hidden":"true"},R={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.88ex",height:"1.602ex",role:"img",focusable:"false",viewBox:"0 -697 831 708","aria-hidden":"true"},O={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.966ex",height:"1.579ex",role:"img",focusable:"false",viewBox:"0 -698 869 698","aria-hidden":"true"},P={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.001ex",height:"1.808ex",role:"img",focusable:"false",viewBox:"0 -583 6188.5 799","aria-hidden":"true"},I={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.46ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7275.4 1000","aria-hidden":"true"},N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.455ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.066ex",height:"1.484ex",role:"img",focusable:"false",viewBox:"0 -455 913.3 656","aria-hidden":"true"},J={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.002ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.961ex",height:"6.039ex",role:"img",focusable:"false",viewBox:"0 -1342 11032.6 2669.1","aria-hidden":"true"},Y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.455ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.066ex",height:"1.484ex",role:"img",focusable:"false",viewBox:"0 -455 913.3 656","aria-hidden":"true"},K={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},W={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.139ex",height:"1.361ex",role:"img",focusable:"false",viewBox:"0 -444 945.3 601.8","aria-hidden":"true"},ss={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},is={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.252ex",height:"1.952ex",role:"img",focusable:"false",viewBox:"0 -705 995.3 862.8","aria-hidden":"true"},as={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ts={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.564ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.126ex",height:"2.26ex",role:"img",focusable:"false",viewBox:"0 -749.5 3591.8 999","aria-hidden":"true"},ns={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ls={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.673ex",height:"2.23ex",role:"img",focusable:"false",viewBox:"0 -974.6 1623.3 985.6","aria-hidden":"true"},hs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ps={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.252ex",height:"1.952ex",role:"img",focusable:"false",viewBox:"0 -705 995.3 862.8","aria-hidden":"true"},ks={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},es={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.531ex",height:"1.946ex",role:"img",focusable:"false",viewBox:"0 -666 2444.7 860","aria-hidden":"true"},rs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ds={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.131ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -666 500 666","aria-hidden":"true"};function Es(gs,i,os,ys,ms,Qs){return l(),n("div",null,[i[104]||(i[104]=t("",6)),s("p",null,[i[2]||(i[2]=a("首先，具有16个内核和AVX-512向量化的2GHz CPU每秒可处理高达",-1)),s("mjx-container",k,[(l(),n("svg",e,[...i[0]||(i[0]=[t("",1)])])),i[1]||(i[1]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"2"),s("mo",null,"⋅"),s("msup",null,[s("mn",null,"10"),s("mn",null,"9")]),s("mo",null,"⋅"),s("mn",null,"16"),s("mo",null,"⋅"),s("mn",null,"32"),s("mo",null,"="),s("msup",null,[s("mn",null,"10"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mn",null,"12")])])])],-1))]),i[3]||(i[3]=a("个字节。 同时，GPU的性能很容易超过该数字100倍。 而另一方面，中端服务器处理器的带宽可能不超过100Gb/s，即不到处理器满负荷所需的十分之一。 更糟糕的是，并非所有的内存入口都是相等的：内存接口通常为64位或更宽（例如，在最多384位的GPU上）。 因此读取单个字节会导致由于更宽的存取而产生的代价。",-1))]),i[105]||(i[105]=s("p",null,[a("其次，第一次存取的额外开销很大，而按序存取（sequential access）或突发读取（burst read）相对开销较小。 有关更深入的讨论，请参阅此"),s("a",{href:"https://en.wikipedia.org/wiki/Cache_hierarchy",target:"_blank",rel:"noreferrer"},"维基百科文章"),a("。")],-1)),s("p",null,[i[8]||(i[8]=a("减轻这些限制的方法是使用足够快的CPU缓存层次结构来为处理器提供数据。 这是深度学习中批量处理背后的推动力。 举一个简单的例子：矩阵-矩阵乘法。 比如",-1)),s("mjx-container",r,[(l(),n("svg",d,[...i[4]||(i[4]=[t("",1)])])),i[5]||(i[5]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")]),s("mo",null,"="),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"B")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"C")])])],-1))]),i[9]||(i[9]=a("，我们有很多方法来计算",-1)),s("mjx-container",E,[(l(),n("svg",g,[...i[6]||(i[6]=[t("",1)])])),i[7]||(i[7]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")])])],-1))]),i[10]||(i[10]=a("。例如，我们可以尝试以下方法：",-1))]),s("ol",null,[s("li",null,[i[13]||(i[13]=a("我们可以计算",-1)),s("mjx-container",o,[(l(),n("svg",y,[...i[11]||(i[11]=[t("",1)])])),i[12]||(i[12]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mi",null,"j")])]),s("mo",null,"="),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"B")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mo",null,","),s("mo",null,":")])]),s("msubsup",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"C")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,":"),s("mo",null,","),s("mi",null,"j")]),s("mi",{mathvariant:"normal"},"⊤")])])],-1))]),i[14]||(i[14]=a("，也就是说，我们可以通过点积进行逐元素计算。",-1))]),s("li",null,[i[21]||(i[21]=a("我们可以计算",-1)),s("mjx-container",m,[(l(),n("svg",Q,[...i[15]||(i[15]=[t("",1)])])),i[16]||(i[16]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,":"),s("mo",null,","),s("mi",null,"j")])]),s("mo",null,"="),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"B")]),s("msubsup",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"C")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,":"),s("mo",null,","),s("mi",null,"j")]),s("mi",{mathvariant:"normal"},"⊤")])])],-1))]),i[22]||(i[22]=a("，也就是说，我们可以一次计算一列。同样，我们可以一次计算",-1)),s("mjx-container",T,[(l(),n("svg",F,[...i[17]||(i[17]=[t("",1)])])),i[18]||(i[18]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")])])],-1))]),i[23]||(i[23]=a("一行",-1)),s("mjx-container",c,[(l(),n("svg",C,[...i[19]||(i[19]=[t("",1)])])),i[20]||(i[20]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mo",null,","),s("mo",null,":")])])])],-1))]),i[24]||(i[24]=a("。",-1))]),s("li",null,[i[27]||(i[27]=a("我们可以简单地计算",-1)),s("mjx-container",A,[(l(),n("svg",x,[...i[25]||(i[25]=[t("",1)])])),i[26]||(i[26]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")]),s("mo",null,"="),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"B")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"C")])])],-1))]),i[28]||(i[28]=a("。",-1))]),s("li",null,[i[35]||(i[35]=a("我们可以将",-1)),s("mjx-container",u,[(l(),n("svg",D,[...i[29]||(i[29]=[t("",1)])])),i[30]||(i[30]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"B")])])],-1))]),i[36]||(i[36]=a("和",-1)),s("mjx-container",w,[(l(),n("svg",b,[...i[31]||(i[31]=[t("",1)])])),i[32]||(i[32]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"C")])])],-1))]),i[37]||(i[37]=a("分成较小的区块矩阵，然后一次计算",-1)),s("mjx-container",B,[(l(),n("svg",f,[...i[33]||(i[33]=[t("",1)])])),i[34]||(i[34]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")])])],-1))]),i[38]||(i[38]=a("的一个区块。",-1))])]),s("p",null,[i[45]||(i[45]=a("如果我们使用第一个选择，每次我们计算一个元素",-1)),s("mjx-container",_,[(l(),n("svg",v,[...i[39]||(i[39]=[t("",1)])])),i[40]||(i[40]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mi",null,"j")])])])],-1))]),i[46]||(i[46]=a("时，都需要将一行和一列向量复制到CPU中。 更糟糕的是，由于矩阵元素是按顺序对齐的，因此当从内存中读取它们时，我们需要访问两个向量中许多不相交的位置。 第二种选择相对更有利：我们能够在遍历",-1)),s("mjx-container",H,[(l(),n("svg",V,[...i[41]||(i[41]=[t("",1)])])),i[42]||(i[42]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"B")])])],-1))]),i[47]||(i[47]=a("的同时，将列向量",-1)),s("mjx-container",L,[(l(),n("svg",M,[...i[43]||(i[43]=[t("",1)])])),i[44]||(i[44]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"C")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,":"),s("mo",null,","),s("mi",null,"j")])])])],-1))]),i[48]||(i[48]=a("保留在CPU缓存中。 它将内存带宽需求减半，相应地提高了访问速度。 第三种选择表面上是最可取的，然而大多数矩阵可能不能完全放入缓存中。 第四种选择提供了一个实践上很有用的方案：我们可以将矩阵的区块移到缓存中然后在本地将它们相乘。 让我们来看看这些操作在实践中的效率如何。",-1))]),i[106]||(i[106]=t("",5)),s("p",null,[i[55]||(i[55]=a("按元素分配只需遍历分别为",-1)),s("mjx-container",j,[(l(),n("svg",Z,[...i[49]||(i[49]=[t("",1)])])),i[50]||(i[50]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"B")])])],-1))]),i[56]||(i[56]=a("和",-1)),s("mjx-container",R,[(l(),n("svg",S,[...i[51]||(i[51]=[t("",1)])])),i[52]||(i[52]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"C")])])],-1))]),i[57]||(i[57]=a("的所有行和列，即可将该值分配给",-1)),s("mjx-container",O,[(l(),n("svg",X,[...i[53]||(i[53]=[t("",1)])])),i[54]||(i[54]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"A")])])],-1))]),i[58]||(i[58]=a("。",-1))]),i[107]||(i[107]=t("",16)),s("p",null,[i[61]||(i[61]=a("之前我们会理所当然地读取数据的",-1)),i[62]||(i[62]=s("em",null,"小批量",-1)),i[63]||(i[63]=a("，而不是观测单个数据来更新参数，现在简要解释一下原因。 处理单个观测值需要我们执行许多单一矩阵-矢量（甚至矢量-矢量）乘法，这耗费相当大，而且对应深度学习框架也要巨大的开销。 这既适用于计算梯度以更新参数时，也适用于用神经网络预测。 也就是说，每当我们执行",-1)),s("mjx-container",P,[(l(),n("svg",z,[...i[59]||(i[59]=[t("",1)])])),i[60]||(i[60]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"w")]),s("mo",{stretchy:"false"},"←"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"w")]),s("mo",null,"−"),s("msub",null,[s("mi",null,"η"),s("mi",null,"t")]),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"g")]),s("mi",null,"t")])])],-1))]),i[64]||(i[64]=a("时，消耗巨大。其中",-1))]),s("mjx-container",I,[(l(),n("svg",G,[...i[65]||(i[65]=[t("",1)])])),i[66]||(i[66]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"g")]),s("mi",null,"t")]),s("mo",null,"="),s("msub",null,[s("mi",null,"∂"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"w")])])]),s("mi",null,"f"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"x")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"t")])]),s("mo",null,","),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"w")]),s("mo",{stretchy:"false"},")"),s("mo",null,".")])],-1))]),s("p",null,[i[69]||(i[69]=a("我们可以通过将其应用于一个小批量观测值来提高此操作的",-1)),i[70]||(i[70]=s("em",null,"计算",-1)),i[71]||(i[71]=a("效率。 也就是说，我们将梯度",-1)),s("mjx-container",N,[(l(),n("svg",q,[...i[67]||(i[67]=[t("",1)])])),i[68]||(i[68]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"g")]),s("mi",null,"t")])])],-1))]),i[72]||(i[72]=a("替换为一个小批量而不是单个观测值",-1))]),s("mjx-container",J,[(l(),n("svg",U,[...i[73]||(i[73]=[t("",1)])])),i[74]||(i[74]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"g")]),s("mi",null,"t")]),s("mo",null,"="),s("msub",null,[s("mi",null,"∂"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"w")])])]),s("mfrac",null,[s("mn",null,"1"),s("mrow",null,[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"B")]),s("mi",null,"t")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])]),s("munder",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mo",null,"∈"),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"B")]),s("mi",null,"t")])])]),s("mi",null,"f"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"x")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i")])]),s("mo",null,","),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"w")]),s("mo",{stretchy:"false"},")"),s("mo",null,".")])],-1))]),s("p",null,[i[85]||(i[85]=a("让我们看看这对",-1)),s("mjx-container",Y,[(l(),n("svg",$,[...i[75]||(i[75]=[t("",1)])])),i[76]||(i[76]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"g")]),s("mi",null,"t")])])],-1))]),i[86]||(i[86]=a("的统计属性有什么影响：由于",-1)),s("mjx-container",K,[(l(),n("svg",W,[...i[77]||(i[77]=[t("",1)])])),i[78]||(i[78]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold"},"x")]),s("mi",null,"t")])])],-1))]),i[87]||(i[87]=a("和小批量",-1)),s("mjx-container",ss,[(l(),n("svg",is,[...i[79]||(i[79]=[t("",1)])])),i[80]||(i[80]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"B")]),s("mi",null,"t")])])],-1))]),i[88]||(i[88]=a("的所有元素都是从训练集中随机抽出的，因此梯度的期望保持不变。 另一方面，方差显著降低。 由于小批量梯度由正在被平均计算的",-1)),s("mjx-container",as,[(l(),n("svg",ts,[...i[81]||(i[81]=[t("",1)])])),i[82]||(i[82]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"b"),s("mo",null,":="),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"B")]),s("mi",null,"t")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])],-1))]),i[89]||(i[89]=a("个独立梯度组成，其标准差降低了",-1)),s("mjx-container",ns,[(l(),n("svg",ls,[...i[83]||(i[83]=[t("",1)])])),i[84]||(i[84]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mi",null,"b"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,"−"),s("mfrac",null,[s("mn",null,"1"),s("mn",null,"2")])])])])],-1))]),i[90]||(i[90]=a("。 这本身就是一件好事，因为这意味着更新与完整的梯度更接近了。",-1))]),s("p",null,[i[93]||(i[93]=a("直观来说，这表明选择大型的小批量",-1)),s("mjx-container",hs,[(l(),n("svg",ps,[...i[91]||(i[91]=[t("",1)])])),i[92]||(i[92]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"B")]),s("mi",null,"t")])])],-1))]),i[94]||(i[94]=a("将是普遍可行的。 然而，经过一段时间后，与计算代价的线性增长相比，标准差的额外减少是微乎其微的。 在实践中我们选择一个足够大的小批量，它可以提供良好的计算效率同时仍适合GPU的内存。 下面，我们来看看这些高效的代码。 在里面我们执行相同的矩阵-矩阵乘法，但是这次我们将其一次性分为64列的“小批量”。",-1))]),i[108]||(i[108]=t("",6)),s("p",null,[i[99]||(i[99]=a("让我们来看看如何从数据中有效地生成小批量。 下面我们使用NASA开发的测试机翼的数据集",-1)),i[100]||(i[100]=s("a",{href:"https://archive.ics.uci.edu/ml/datasets/Airfoil+Self-Noise",target:"_blank",rel:"noreferrer"},"不同飞行器产生的噪声",-1)),i[101]||(i[101]=a("来比较这些优化算法。 为方便起见，我们只使用前",-1)),s("mjx-container",ks,[(l(),n("svg",es,[...i[95]||(i[95]=[t("",1)])])),i[96]||(i[96]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"1"),s("mo",null,","),s("mn",null,"500")])],-1))]),i[102]||(i[102]=a("样本。 数据已作预处理：我们移除了均值并将方差重新缩放到每个坐标为",-1)),s("mjx-container",rs,[(l(),n("svg",ds,[...i[97]||(i[97]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mn"},[s("path",{"data-c":"31",d:"M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z",style:{"stroke-width":"3"}})])])],-1)])])),i[98]||(i[98]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"1")])],-1))]),i[103]||(i[103]=a("。",-1))]),i[109]||(i[109]=t("",44))])}const cs=h(p,[["render",Es]]);export{Fs as __pageData,cs as default};
